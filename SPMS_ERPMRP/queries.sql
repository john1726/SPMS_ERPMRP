--
-- Script was generated by Devart dbForge Studio 2020 for MySQL, Version 9.0.304.0
-- Product home page: http://www.devart.com/dbforge/mysql/studio
-- Script date 6/18/2020 8:54:47 AM
-- Server version: 8.0.20
-- Client version: 4.1
--


SET NAMES 'utf8';

INSERT INTO spms_erpmrp.queries(QueryName, QuerySQL) VALUES
('qryDayspaid', 'SELECT Employees.EmployeeID, LastName,[FirstName] & " " & [LastName] AS Employee, \r\nWeekStart(1,WorkDate) AS WeekStarting\r\nFROM Employees INNER JOIN TimeLog \r\nON Employees.EmployeeID = TimeLog.EmployeeID\r\nUNION SELECT Employees.EmployeeID, LastName,[FirstName] & " " & [LastName], \r\nWeekStart(1,WorkDate)\r\nFROM Employees INNER JOIN EmployeeUnworkedTimes \r\nON Employees.EmployeeID = EmployeeUnworkedTimes.EmployeeID;'),
('qryTimeWorked', 'PARAMETERS Forms!frmWeeklyTimeSheet!cboEmployeeID LONG, \r\nForms!frmWeeklyTimeSheet!cboWeekStarting DATETIME;\r\nSELECT TimeLog.EmployeeID, TimeLog.WorkDate, TimeStart, TimeEnd,\r\nTimeDurationAsDate([TimeLog].[TimeStart],[TimeLog].[TimeEnd]) AS TimeWorked,\r\nWeekStart(1,[WorkDate]) AS WeekStarting, HourlyPayRate, \r\nTimeDurationAsDate([TimeLog].[TimeStart],[TimeLog].[TimeEnd])*24*[HourlyPayRate] AS Payment\r\nFROM TimeLog INNER JOIN EmployeePayRates ON (TimeLog.EmployeeID=EmployeePayRates.EmployeeID) \r\nAND (TimeLog.WorkDate BETWEEN EmployeePayRates.DateFrom AND Nz(EmployeePayRates.DateTo,#1/1/2200#))\r\nWHERE TimeLog.EmployeeID=Forms!frmWeeklyTimeSheet!cboEmployeeID \r\nAND WeekStart(1,[WorkDate])=Forms!frmWeeklyTimeSheet!cboWeekStarting\r\nORDER BY WorkDate, TimeStart;'),
('qryTimeWorkedALL', 'SELECT TimeLog.EmployeeID, [FirstName] & " " & [LastName] AS Employee, \r\nTimeLog.WorkDate, TimeLog.TimeStart, TimeLog.TimeEnd, \r\nTimeDurationAsDate([TimeLog].[TimeStart],[TimeLog].[TimeEnd]) AS TimeWorked, \r\nWeekStart(1,[WorkDate]) AS WeekStarting, \r\nEmployeePayRates.HourlyPayRate, \r\nTimeDurationAsDate([TimeLog].[TimeStart],[TimeLog].[TimeEnd])*24*[HourlyPayRate] AS Payment\r\nFROM Employees INNER JOIN (TimeLog INNER JOIN EmployeePayRates \r\nON TimeLog.EmployeeID = EmployeePayRates.EmployeeID \r\nAND (TimeLog.WorkDate BETWEEN EmployeePayRates.DateFrom \r\nAND Nz(EmployeePayRates.DateTo,#1/1/2200#))) \r\nON (Employees.EmployeeID = TimeLog.EmployeeID) \r\nAND (Employees.EmployeeID = EmployeePayRates.EmployeeID) \r\nORDER BY WorkDate, TimeStart;'),
('qryTimeWorkedAll_Sub', 'SELECT TimeLog.EmployeeID, TimeLog.WorkDate, TimeLog.TimeStart, TimeLog.TimeEnd, \r\nTimeDurationAsDate([TimeLog].[TimeStart],[TimeLog].[TimeEnd]) AS TimeWorked, \r\nWeekStart(1,[WorkDate]) AS WeekStarting, EmployeePayRates.HourlyPayRate, \r\nTimeDurationAsDate([TimeLog].[TimeStart],[TimeLog].[TimeEnd])*24*[HourlyPayRate] AS Payment\r\nFROM TimeLog INNER JOIN EmployeePayRates ON (TimeLog.EmployeeID=EmployeePayRates.EmployeeID) \r\nAND (TimeLog.WorkDate Between EmployeePayRates.DateFrom And Nz(EmployeePayRates.DateTo,#1/1/2200#))\r\nORDER BY WorkDate, TimeStart;'),
('qryTotalPayment', 'SELECT SUM(TotalPayments) AS TotalPayment\r\nFROM\r\n    (SELECT SUM(Payment)  AS TotalPayments\r\n     FROM qryTimeWorked\r\n     UNION ALL SELECT SUM(Payment)\r\n     FROM qryUnworkedTimes);'),
('qryUnworkedTimes', 'PARAMETERS Forms!frmWeeklyTimeSheet!cboEmployeeID LONG, \r\nForms!frmWeeklyTimeSheet!cboWeekStarting DATETIME;\r\nSELECT EmployeeUnworkedTimes.EmployeeID, EmployeeUnworkedTimes.WorkDate,\r\nUnworkedTimeCategories.UnworkedTimeCategory, EmployeeUnworkedTimes.UnworkedTime,\r\nWeekStart(1,[WorkDate]) AS WeekStarting, HourlyPayRate,\r\n[UnworkedTime]*24*[EmployeePayRates].[HourlypayRate] AS Payment\r\nFROM (EmployeeUnworkedTimes INNER JOIN EmployeePayRates \r\nON (EmployeeUnworkedTimes.WorkDate BETWEEN EmployeePayRates.DateFrom \r\nAND Nz(EmployeePayRates.DateTo,#1/1/2200#)) \r\nAND (EmployeeUnworkedTimes.EmployeeID=EmployeePayRates.EmployeeID)) \r\nINNER JOIN UnworkedTimeCategories ON EmployeeUnworkedTimes.UnworkedTimeCategoryID=UnworkedTimeCategories.UnworkedTimeCategoryID\r\nWHERE EmployeeUnworkedTimes.EmployeeID=Forms!frmWeeklyTimeSheet!cboEmployeeID \r\nAND WeekStart(1,[WorkDate])=Forms!frmWeeklyTimeSheet!cboWeekStarting\r\nORDER BY WorkDate, UnworkedTimeCategory;'),
('qryUnworkedTimesAll', 'SELECT EmployeeUnworkedTimes.EmployeeID, EmployeeUnworkedTimes.WorkDate,\r\nUnworkedTimeCategories.UnworkedTimeCategory, EmployeeUnworkedTimes.UnworkedTime,\r\nWeekStart(1,[WorkDate]) AS WeekStarting, HourlyPayRate,\r\n[UnworkedTime]*24*[EmployeePayRates].[HourlypayRate] AS Payment\r\nFROM (EmployeeUnworkedTimes INNER JOIN EmployeePayRates \r\nON (EmployeeUnworkedTimes.WorkDate BETWEEN EmployeePayRates.DateFrom \r\nAND Nz(EmployeePayRates.DateTo,#1/1/2200#)) \r\nAND (EmployeeUnworkedTimes.EmployeeID=EmployeePayRates.EmployeeID)) \r\nINNER JOIN UnworkedTimeCategories \r\nON EmployeeUnworkedTimes.UnworkedTimeCategoryID=UnworkedTimeCategories.UnworkedTimeCategoryID\r\nORDER BY WorkDate, UnworkedTimeCategory;');